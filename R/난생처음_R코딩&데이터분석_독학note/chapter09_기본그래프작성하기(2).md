# 난생처음 R 코딩 & 데이터 분석 - Chapter 09. 기본 그래프 작성하기 (2)

## 원그래프와 선그래프를 작성해봅니다

### 원그래프의 작성

원그래프는 하나의 원 안에 데이터값이 차지하는 비율을 넓이로 나타낸 그래프이다.  
**도수분포표**로 쉽게 원그래프를 작성할 수 있다.  

`pie()` 함수를 이용해서 원그래프를 작성하며,  

- 첫번째 매개변수로 들어간 데이터셋에 저장된 값들을 *시계 반대 방향*으로 따라가면서 파이 조각으로 표시한다.  
- 세번째 매개변수 `radius=`는 -1 부터 1 사이의 값으로 원의 크기와 데이터를 표시하는 방향을 조절하는데, 보통 1로 지정한다. 
- `col=` 매개변수를 넣어줘서 파이 조각의 색을 내가 원하는 색으로 바꿀 수 있다. 

### 3차원 원그래프의 작성

3차원 원그래프는 `pie3D()` 함수를 이용하여 작성한다.  
이 함수를 이용하기 위해서는 `plotrix` 패키지를 설치해야한다. 

- `labels=` : 파이 별 레이블을 지정하는 기능으로, 보통 `names(dataset)`을 사용한다. 
- `labelcex=1.0` : 레이블의 폰트 크기를 지정
- `explode=0.1` : 파이 간의 간격을 지정
- `radius=1.5` : 파이의 크기 지정

### 선그래프의 작성

선그래프는 시간의 변화에 따라 수집된 데이터를 시각화하는데 주로 사용된다.  
시간 변화에 따라 데이터를 분석한 경우, 이를 **시계열 데이터**라고 부른다.

`plot()` 함수를 이용해서 선그래프를 작성한다.  

- 첫번째 매개변수로는 x축에 들어갈 데이터를 입력해준다.
- 두번째 매개변수는 y축에 들어갈 데이터를 입력한다.
- `main=` : 그래프의 제목을 입력
- `type=l` : 작성하려는 선그래프의 종류를 지정 (l, b, s, o)
- `lty=1` : 선의 종류 (line type) 선택
- `lwd=1` : 선의 굵기 (line width) 선택
- `xlab= , ylab=` : x축과 y축 레이블 지정
- `ylim=c(n,m)` : y축의 범위 지정. (n부터 m까지)

### 복수의 선그래프 작성하기

선그래프는 하나의 선 뿐만 아니라 복수의 선도 나타낼 수 있다.  

위에서 작성해뒀던 `plot()` 함수는 그대로 입력하고, 추가할 선을 `lines()`를 이용해 더 입력해준다.  
`lines()` 함수는 `plot()` 함수로 작성한 그래프 위에 선을 겹쳐서 그리는 역할을 한다.  
함수를 추가할 때마다 선이 하나씩 추가된다.  


## 상자그림에 대해 알아봅니다

상자그림(boxplot)은 **사분위수를 시각화하여 그래프 형태로 나타낸 것**으로,  
데이터의 분포 형태를 포함한 다양한 정보를 전달하기 때문에 **단일변수 수치형 자료**를 파악하는 데 자주 사용된다.  

`boxplot()` 함수를 이용해서 상자그림을 작성한다.

상자그림은 상자가 세로 방향으로 표시되는데, 데이터의 관측값들이 작은 값부터 큰 값 순으로 아래에서 위로 세워져 있는 것과 대응된다.  
*때문에 가로 방향으로 정보를 읽는 것은 의미가 없으며, 따라서 상자의 면적도 의미를 갖지 않는다.*

- 상자그림의 y축은 총 자료의 범위를 나타낸 것으로, 데이터값들이 갖는 범위를 등간격 눈금으로 나타냈다. 
- 아래서부터 차례로 최솟값, 1사분위수, 중앙값, 3사분위수, 최댓값이 표시되며  
*여기서의 최솟값과 최댓값은 **정상 범위 내의** 최솟값과 최댓값을 의미한다.*  
- 상자는 1사분위수(앞에서 25번째 값)과 3사분위수(앞에서 75번째 값) 사이의 데이터를 의미하며, **전체 데이터의 50%가 모여있는 구간**을 나타낸다.  
즉, 전체를 대표할만한 주류 데이터가 모여있는 구간을 의미한다.  
- 정상 범위 밖에 있는 값을 이상치(outlier) 또는 특이값이라고 하며, 작은 동그라미로 표현된다. 

그런데, 상자그림은 데이터의 전반적인 분포형태를 파악하는데는 도움이 되지만,  
구체적인 최소/최대값, 중앙값 등이 얼마인지는 알기 어렵다.  

이 때 쓰는 함수가 `boxplot.stats()` 함수이며,  
출력 결과는 **리스트(list)** 형태로 나온다.  
출력된 리스트에서 각 원소의 의미는 아래와 같다.  

- `$stats` : 총 5개의 값이 나오며, 차례대로 최솟값, 1사분위수, 중앙값, 3사분위수, 최댓값의 순서이다. 
- `$n` : 관측값들의 개수
- `$conf` : 중앙값에 관련된 신뢰 구간
- `$out` : 이상치들의 목록


### 그룹이 있는 데이터의 상자그림

단일변수 데이터 중에는 그룹 정보가 포함되어 있는 데이터도 있다.  
(예를 들어 iris 데이터셋의 Species 열)  

이런 경우는 데이터의 관측값들을 품종 별로 나눈 뒤, 품종 그룹 별로 상자그림을 그리면  
품종들 간 데이터의 분포가 어떻게 다른지를 확인할 수 있어서 유용하다.  

`boxplot(Petal.Length ~ Species, iris, ...)`  

- 첫번째 파라미터로 ~ 를 이용해서 데이터와 그룹 정보를 묶어준다.  
- 두번째 파라미터로는 데이터셋을 넣어준다. 

그러면 **하나의 그래프 안에 상자그림이 그룹의 개수만큼 만들어진 그래프**가 추출된다. 

*만약, 상자그림을 그릴 대상 데이터와 그룹 정보 데이터가 동일한 데이터셋에 있지 않을 때는,*  
*두번째 파라미터(데이터셋)는 생략하고, 첫번째 파라미터에 `데이터셋$열 ~ 데이터셋$그룹열` 와 같이 넣어주면 된다.*

~~그룹 별로 상자그림 그래프 그리는 건 boxplot.stats() 함수는 적용이 불가한 것 같다.~~

**비교할 두 데이터 셋은 행의 개수만 맞으면 비교가 가능하다!**

## 산점도란 무엇인가요?

산점도(scatter plot)는 다중변수 데이터에서 **두 변수**에 포함된 값들을 2차원 그래프 상에 점으로 표현하여 **분포**를 관찰할 수 있도록 하는 도구이다.  

다중변수 데이터란 *여러 주제(column)의 데이터를 하나로 모은 2차원 형태의 데이터*를 말한다.  

데이터의 주제(column)을 통계 용어로 **변수(variable)**라고 한다.  
이 때, 프로그래밍 용어로서의 변수와는 의미가 다르니 문맥에 따라 다르게 이해해야 한다. 

`plot()` 함수를 이용하여 산점도를 그릴 수 있다.  
- 첫번째 매개변수로는 x축에 해당하는 데이터(벡터)를 넣어준다.
- 두번째 매개변수로는 y축에 해당하는 데이터(벡터)를 넣어준다. 
- main, xlab, ylab, col 등은 기존 방법을 그대로 적용시킬 수 있다. 
- `pch=` 는 산점도 그래프 내의 점의 모양을 지정하는 매개변수로, 다양한 값들을 넣을 수 있다.


`plot(v1, v2)` 이런 형식으로 넣을 수도 있고,  
`plot(v1 ~ v2, data=ds)` 이런 형식으로도 넣을 수 있다.

### 여러 변수들 간의 산점도

산점도는 기본적으로 2개의 변수에 대해서 작성하는 것이다.  
따라서 변수가 2개 이상인 데이터를 함수 안에 넣게 되면, 변수를 2개씩 짝지어서 산점도가 작성된다.

**다중 산점도는 여러 변수들 간의 추세를 한눈에 파악할 수 있어서 편리하다.**

이렇게 만들어진 다중 산점도에는 변수들의 이름이 *대각선*에 표기되어 있고,  
두 변수가 만나는 지점에 두 변수에 대한 산점도가 나타난다.  

다중 산점도는 *대각선을 기준으로 오른쪽 위의 산점도들과 왼쪽 아래의 산점도들이 대칭*을 이루는데,   
동일한 산점도인데 **x축, y축만 바뀌어 있다!**


### 그룹 정보가 있는 2개 변수의 산점도

만약 그룹 정보가 있는 데이터라면, 각 그룹 별 관츠값들을 다른 색깔과 다른 점의 모양으로 산점도에 표시하는 것이 가능하다.  
이렇게 작성된 산점도는 두 변수 간의 관계 뿐만 아니라 그룹 간의 관계도 파악할 수 있어서 편리하다.  

`levels()` 함수를 이용해서 그룹을 확인하고,  
그걸 `pch=` 매개변수 안에 활용할 수 있게 `as.numeric()`을 이용해서 숫자로 바꿔준다.  
이렇게 바꿔준 그룹을 pch 매개변수에 넣어주고, color도 그룹의 숫자에 맞춰서 각각 다르게 넣어주면 된다.  

### 산점도에 범례 표시하기

범례 표시의 예시는 아래와 같다. 

```r
legend(x="bottomright", 
        legend=levels(iris$Species),
        col=c("red", "green", "blue"),
        pch=c(1:3))
```

- 첫번째 매개변수인 `x=`의 값으로는 산점도가 위치할 곳을 지정해준다.
- 두번째 매개변수로는 범례의 레이블을 지정해준다.
- 세번째 매개변수로는 위의 산점도 함수에서 이용한 컬러 값들을 넣어준다.
- 네번째 매개변수로는 위의 산점도 함수에서 이용한 점의 모양들을 넣어준다.



