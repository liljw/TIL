# 난생처음 R 코딩 & 데이터 분석 - Chapter 08. 기본 그래프 작성하기 (1)

데이터가 포함하고 있는 정보를 이해하기 쉽게 표현하는 과정을 **데이터 시각화(Data Visualization)**이라고 한다.  
인간은 숫자보다 이미지로부터 보다 쉽게 정보를 습득하기 때문에 데이터 시각화 기법을 익히는 것은 중요하다.  
데이터 시각화 작업에 기본적으로 사용되는 다양한 그래프 작성 방법에 대해 배워보자. 

## 막대그래프를 작성해봅시다

막대그래프는 **그룹이나 범주가 정해져 있는 데이터**를 시각화하는데 사용된다.  

막대그래프는 그룹별로 집계된 데이터를 표현하는 도구이기 때문에,  
막대그래프를 작성하기 위해서는 먼저 *그룹별로 데이터를 집계하는 작업*이 필요하다. 

- 단일변수 자료 : 단일 특성에 대해 데이터를 수집한 것
- 범주형 자료 : 크기를 측정할 수 없는 자료

### 도수분포표 계산하기

`table()` 함수는 벡터에 저장된 범주형 데이터에 대해 데이터 값을 종류별로 집계해주는 함수이다.  
이렇게 도수분포로 **각 데이터의 종류별 빈도**를 파악할 수 있고, 이 내용을 도표로 나타낸 것이 도수분포표이다. 

위에서 `table()` 함수를 이용해 도수분포표를 저장하고, 막대그래프를 작성해주자.   

**`barplot(도수분포표, main="막대그래프 상단의 그래프 title")`**  

그래프에서 x축은 관측값의 종류를 나타내고, y축은 빈도를 나타낸다.  

### 그래프 상세 설정

- 그래프의 색을 지정해줄 수도 있다.  
`col="blue"` 와 같이 col값을 그래프 함수를 만들 때 매개변수로 넣어주면 된다.  
`colors()` 함수를 실행하면 R 그래프에 사용할 수 있는 색의 이름을 알 수 있다. 

- 만약 막대 별로 색을 다르게 지정하고 싶다면,  
`c()`를 이용해서 막대의 개수만큼 색을 지정하면 된다.  
ex) `col=c("Blue", "Orange", "Red", "Green")`

- 일일이 색을 지정하는 게 번거롭다면 팔레트를 이용하는 방법도 있다.  
`rainbow(), heat.colors(), terrain.colors(), topo.colors(), cm.colors()` 등등이 있으며,  
`col=rainbow(4)` 처럼 함수 안에 막대의 갯수를 넣어주면 된다.  

- x축, y축에 이름을 붙여줄 수도 있다.   
`xlab="제목", ylab="제목"` 을 파라미터로 추가해준다.  

- 그래프 막대를 수평 방향으로 출력할 수도 있다.  
그럴 때는 `horiz=TRUE` 값을 파라미터로 넣어준다.  
매개변수 horiz의 기본값은 FALSE 이다. 

- x축의 그룹 이름을 바꿔서 출력하고 싶다면,  
`names=c("이름1", "이름2", "이름3", "이름4")` 로 넣어주면 된다.  

- x축의 그룹 이름이 너무 길다면, 이름끼리 겹치는 경우가 생길 수 있다.  
이럴 때 그룹 이름을 수직방향으로 출력하면 겹치지 않게 나타낼 수 있다.  
매개변수 `las=`를 넣어주면 되는데, las 값을 뭐로 넣어주느냐에 따라 방향 설정을 할 수 있다.  
    - `las=0`: 축 방향 (기본값)
    - `las=1` : 수평 방향 (축 방향과 상관없음)
    - `las=2` : 축을 기준으로 수직 방향
    - `las=3` : 수직 방향 (축 방향과 상관없음)

### 중첩그룹의 막대그래프

데이터 중에는 그룹 안에 또 다른 그룹이 존재하는 경우가 있다.  
예를 들어 20년 간격으로 우리나라의 인구를 추정한 데이터가 있다고 할 때,  
첫번째로는 연도별로 그룹이 나누어져 있고,  
두번째로는 연도 안에서도 연령대별로 그룹이 존재할 수 있다.  

이런 경우 barplot() 기본 함수에 데이터를 넣어주면,  
막대 그래프가 색으로 구분되서 분할된 형태의 그래프가 그려진다.   

분할 된 막대도 색을 다르게 지정할 수 있다.  
`col=` 매개변수 사용이 가능한데,  
색의 순서는 그래프의 막대를 기준으로 아래에서 위쪽 방향으로 순서가 적용된다.  

또한, 하나의 막대를 여러 데이터가 분할하는 형식이 아니라  
각각의 막대로 표현할 수도 있다.  
`beside=TRUE` 매개변수를 넣어주면 된다.  

### 막대그래프에 범례 추가

어느 막대가 어떤 값을 의미하는지 알기 쉽게 도와주는 것이 범례(legend)이다.  
`legend.text=T` 값을 매개변수로 넣어주면 그래프 위에 범례가 표시된다.  
하지만, 실제로 실행해보면 막대그래프와 겹쳐져서 보이지 않는 부분이 생긴다.  

그래서, 범례를 그래프 밖에 표시하도록 설정해줄 수 있다.  
이를 위해서는 범례를 표시할 충분한 공간을 미리 설정해야 한다.  

`par(mfrow=c(1,1), mar=c(5,5,5,7))`  
- **par() 함수는 매개변수가 아니다! 때문에 barplot()함수를 쓰기 전에 따로 다른 라인에 써주어야한다!**
- mfrow값은 그래프를 출력할 창을 어떻게 분할 할 지 지정하는데, c(1,1)은 창을 분할하지 않는 것을 의미한다. 
- mar 값은 css식의 margin과 비슷하다. 그래프를 출력할 창과 그래프 출력 영역 밖의 여유 공간을 지정해주는 건데, c(bottom, left, top, right)의 순서로 숫자를 지정한다.
- 범례를 오른쪽에 출력하기 위해서 오른쪽에 여유 공간을 더 많이 설정해주어야 한다. 
- **par() 함수를 한번 실행시켜주면 R이 실행되는 동안 계속해서 설정값이 유지된다.**  
따라서 그래프 작업을 마무리할 때 원래의 설정값으로 되돌려주는 것이 좋다.  
`par(mfrow=c(1,1), mar=(5,4,4,2)+0.1)`  
해당 코드를 입력해주면 그래프창의 설정이 해제된다. 

`args.legend = list(x="topright", bty="n", inset=c(-0.25,0))`
- x값은 범례를 출력할 기본 위치를 지정하는데, topright은 그래프 출력 영역의 위쪽/오른쪽을 의미한다. 
- bty는 범례가 표시되는 영역에 테두리선을 표시할지의 여부를 지정한다. 'o'는 테두리선을 표시하고, 'n'은 표시하지 않는다. 
- inset은 범례를 x축과 y축의 방향으로 얼마나 이동시킬지를 지정한다. -1 ~ 1 사이의 값을 지정한다.  
*inset에서 x축, y축의 기준은 매개변수 x의 값에 따라 달라진다.*

범례는 데이터의 행 이름으로 표시되는 게 기본값이다.  
만약 바꾸고 싶다면 원하는 내용을 아래와 같이 직접 입력해줄 수 있다.  
`legend.text=c("0~14세", "15~64세","65세 이상")`

---

## 히스토그램을 작성해봅니다





